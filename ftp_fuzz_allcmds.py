#!/usr/bin/python
#Fuzzes all commands from the RFC, does not fuzz the USER or PASS commands, those must be enabled

from boofuzz import *
from sys import exit

target_ip = "X.X.X.X"
target_port = 21

def main():
    
    t = Target(connection = SocketConnection(target_ip, target_port, proto='tcp'))
    session = Session(target=t, crash_threshold_element = 20)
    
    s_initialize("user")
    s_string("USER", fuzzable=False)
    s_delim(" ", fuzzable=False)
    s_string("test", fuzzable=False)
    s_static("\r\n")

    s_initialize("pass")
    s_string("PASS", fuzzable=False)
    s_delim(" ", fuzzable=False)
    s_string("test", fuzzable=False)
    s_static("\r\n")

    s_initialize("commands")
    s_group("Commands",["ABOR", "ACCT", "ADAT", "ALLO", "APPE", "AUTH", "CCC", "CDUP", "CONF", "CWD", "DELE", "ENC", "EPRT", "EPSV", "FEAT", "HELP", "LANG", "LIST", "LPRT", "LPSV", "MDTM", "MIC", "MKD", "MLSD", "MLST", "MODE", "NLST", "NOOP", "OPTS", "PASV", "PBSZ", "PORT", "PROT", "PWD", "REIN", "REST", "RETR", "RMD", "RNFR", "RNTO", "SITE", "SIZE", "SMNT", "STAT", "STOR", "STOU", "STRU", "SYST", "TYPE", "XCUP", "XMKD", "XPWD", "XRCP", "XRMD", "XRSQ", "XSEM", "XSEN"])
    s_delim(" ", fuzzable=False)
    s_string("data")
    s_static("\r\n")

    session.connect(s_get("user"))
    session.connect(s_get("user"), s_get("pass"))
    session.connect(s_get("pass"), s_get("commands"))

    session.fuzz()


if __name__ == '__main__':
    main()
