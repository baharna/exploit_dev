#!/usr/bin/python
# <3 boofuzz
# Older versions I wrote had logging and process monitor etc in there
# I wanted something simple for this, just output to the screen
# Get the commands from the RFC 

from boofuzz import *
from sys import exit

target_ip = "X.X.X.X"
target_port = 21

def main():
    
    t = Target(connection = SocketConnection(target_ip, target_port, proto='tcp'))
    session = Session(target=t, crash_threshold_element = 20)
    
    s_initialize("user")
    s_string("USER", fuzzable=False)
    s_delim(" ", fuzzable=False)
    s_string("test", fuzzable=False)
    s_static("\r\n")

    s_initialize("pass")
    s_string("PASS", fuzzable=False)
    s_delim(" ", fuzzable=False)
    s_string("test", fuzzable=False)
    s_static("\r\n")

    s_initialize("pasv")
    s_string("PASV", fuzzable=False)
    s_delim(" ", fuzzable=False)
    s_string("data")
    s_static("\r\n")

    s_initialize("retr")
    s_string("RETR", fuzzable=False)
    s_delim(" ", fuzzable=False)
    s_string("data")
    s_static("\r\n")

    session.connect(s_get("user"))
    session.connect(s_get("user"), s_get("pass"))
    session.connect(s_get("pass"), s_get("pasv"))
    #session.connect(s_get("pass"), s_get("retr"))

    session.fuzz()


if __name__ == '__main__':
    main()
